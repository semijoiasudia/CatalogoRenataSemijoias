<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo de Semijoias</title>
    
    <!-- CSS incorporado -->
    <style>
        /* Reset b√°sico e estilos globais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            line-height: 1.5;
            color: #212529;
        }
        
        /* Vari√°veis de cores */
        :root {
            --cor-primaria: #f8f5ed;
            --cor-secundaria: #d5c7a3; 
            --dark-color: #4a4a4a;
            --light-color: #f8f9fa;
        }
        
        /* Utilit√°rios do Bootstrap que precisamos */
        .container {
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
            margin-right: auto;
            margin-left: auto;
        }
        
        @media (min-width: 576px) {
            .container {
                max-width: 540px;
            }
        }
        
        @media (min-width: 768px) {
            .container {
                max-width: 720px;
            }
        }
        
        @media (min-width: 992px) {
            .container {
                max-width: 960px;
            }
        }
        
        @media (min-width: 1200px) {
            .container {
                max-width: 1140px;
            }
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -15px;
            margin-left: -15px;
        }
        
        .col-12, .col-md-4, .col-md-6, .col-md-8, .col-lg-3 {
            position: relative;
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
        }
        
        .col-6 {
            flex: 0 0 50%;
            max-width: 50%;
        }
        
        .col-12 {
            flex: 0 0 100%;
            max-width: 100%;
        }
        
        @media (min-width: 768px) {
            .col-md-4 {
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }
            .col-md-6 {
                flex: 0 0 50%;
                max-width: 50%;
            }
            .col-md-8 {
                flex: 0 0 66.666667%;
                max-width: 66.666667%;
            }
            .mx-auto {
                margin-left: auto !important;
                margin-right: auto !important;
            }
        }
        
        @media (min-width: 992px) {
            .col-lg-3 {
                flex: 0 0 25%;
                max-width: 25%;
            }
        }
        
        /* Utilidades de espa√ßamento */
        .mb-3 { margin-bottom: 1rem !important; }
        .mb-4 { margin-bottom: 1.5rem !important; }
        .mt-5 { margin-top: 3rem !important; }
        .py-3 { padding-top: 1rem !important; padding-bottom: 1rem !important; }
        .px-3 { padding-left: 1rem !important; padding-right: 1rem !important; }
        
        /* Classes de alinhamento */
        .text-center { text-align: center !important; }
        .align-items-center { align-items: center !important; }
        .justify-content-center { justify-content: center !important; }
        .d-flex { display: flex !important; }
        .d-inline-flex { display: inline-flex !important; }
        .d-none { display: none !important; }
        
        @media (min-width: 768px) {
            .d-md-flex {
                display: flex !important;
            }
        }
        
        /* Formul√°rios e inputs */
        .form-control {
            display: block;
            width: 100%;
            height: calc(1.5em + 0.75rem + 2px);
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        .btn {
            display: inline-block;
            font-weight: 400;
            color: #212529;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            background-color: transparent;
            border: 1px solid transparent;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.25rem;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        /* Alertas */
        .alert {
            position: relative;
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: 0.25rem;
        }
        
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }
        
        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }
        
        /* Estilo do logo */
        .logo {
            max-height: 100px;
            width: auto;
        }
        
        /* √çcones b√°sicos (substitutos para Font Awesome) */
        .icon {
            display: inline-block;
            width: 1em;
            height: 1em;
            vertical-align: -0.125em;
            margin-right: 0.5rem;
        }
        
        .icon-search::before {
            content: 'üîç';
        }
        
        .icon-grid::before {
            content: '‚ñ§';
        }
        
        .icon-gem::before {
            content: 'üíé';
        }
        
        .icon-left::before {
            content: '‚óÄ';
        }
        
        .icon-right::before {
            content: '‚ñ∂';
        }
        
        /* Estilos da barra de busca */
        .search-container {
            position: relative;
            margin-bottom: 20px;
            margin-top: 10px;
        }
        
        .search-btn {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            background-color: var(--cor-secundaria);
            color: var(--dark-color);
            border-radius: 0 4px 4px 0;
        }
        
        .search-btn:hover {
            background-color: var(--cor-primaria);
            color: var(--dark-color);
        }
        
        /* Container de categorias */
        .categories-nav {
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            padding: 1rem 0;
            margin-bottom: 20px;
            position: relative;
        }
        
        /* Estilos dos Bot√µes de Categoria */
        .category-btn {
            background: white;
            border: 2px solid var(--cor-primaria);
            color: #888888; /* Cor cinza intermedi√°ria para bot√µes n√£o selecionados */
            border-radius: 30px;
            padding: 0.8rem 2rem;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        /* Estados dos Bot√µes */
        .category-btn.active,
        .category-btn:hover {
            background: var(--cor-primaria);
            color: var(--dark-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* Efeito de Press√£o ao Clicar */
        .category-btn:active {
            transform: translateY(1px);
            transition: transform 0.1s;
        }
        
        /* √çcones nos Bot√µes */
        .category-btn .icon {
            transition: transform 0.3s ease;
        }
        
        .category-btn:hover .icon {
            transform: rotate(15deg);
        }
        
        /* Setas de Navega√ß√£o */
        .scroll-arrow-btn {
            background: var(--cor-primaria);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16);
            transition: all 0.2s ease;
            cursor: pointer;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }
        
        .scroll-left {
            left: 0;
        }
        
        .scroll-right {
            right: 0;
        }
        
        .scroll-arrow-btn:hover {
            transform: translateY(-50%) scale(1.1);
            background: var(--cor-secundaria);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* Efeito de Gradiente nas Bordas */
        .category-btn::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 30px;
            background: linear-gradient(45deg, 
                var(--cor-primaria), 
                var(--cor-secundaria), 
                var(--cor-primaria));
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .category-btn:hover::after {
            opacity: 0.3;
        }
        
        /* Estilos de cards de produtos */
        .product-card {
            border: 1px solid #e0e0e0;
            border-radius: 4px; 
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
            background-color: white;
            height: 100%;
            cursor: pointer;
        }
        
        .product-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        
        .product-img-container {
            height: 200px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #fbfbfb;
        }
        
        .product-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-code {
            font-size: 0.8rem;
            color: #999;
            margin-bottom: 5px;
        }
        
        .product-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
            height: 40px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .product-price {
            font-size: 1.2rem;
            color: var(--dark-color);
            font-weight: bold;
        }
        
        .product-bath {
            font-size: 0.9rem;
            color: #888;
        }
        
        /* Estilos do modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            padding-top: 60px;
        }
        
        .modal.show {
            display: block;
        }
        
        .modal-dialog {
            position: relative;
            width: auto;
            margin: 0.5rem auto;
            max-width: 800px;
        }
        
        .modal-content {
            position: relative;
            display: flex;
            flex-direction: column;
            width: 100%;
            background-color: #fff;
            background-clip: padding-box;
            border-radius: 0.3rem;
            outline: 0;
        }
        
        .modal-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            border-top-left-radius: 0.3rem;
            border-top-right-radius: 0.3rem;
        }
        
        .modal-title {
            margin-bottom: 0;
            line-height: 1.5;
            font-size: 1.25rem;
        }
        
        .btn-close {
            background: transparent;
            border: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: #000;
            opacity: 0.5;
            cursor: pointer;
        }
        
        .modal-body {
            position: relative;
            flex: 1 1 auto;
            padding: 1rem;
        }
        
        .modal-product-image {
            max-height: 300px;
            max-width: 100%;
            object-fit: contain;
            margin: 0 auto;
            display: block;
        }
        
        .modal-product-details {
            margin-top: 20px;
        }
        
        .modal-product-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .modal-product-code {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 10px;
        }
        
        .modal-product-price {
            font-size: 1.5rem;
            color: var(--dark-color);
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .modal-product-bath {
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        /* Loading spinner */
        .spinner-border {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
        }
        
        @keyframes spinner-border {
            to { transform: rotate(360deg); }
        }
        
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        #loading-indicator {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        /* Footer */
        footer {
            background-color: #f8f9fa;
            padding: 1rem 0;
            margin-top: 3rem;
            text-align: center;
        }
        
        /* Responsivo */
        @media (max-width: 768px) {
            .product-img-container {
                height: 150px;
            }
            
            .category-btn {
                padding: 0.6rem 1.5rem;
                font-size: 0.9rem;
                margin: 0 0.3rem;
            }
            
            .scroll-arrow-btn {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
            
            .product-title {
                font-size: 0.9rem;
                height: 35px;
            }
            
            .product-price {
                font-size: 1rem;
            }
            
            .product-bath {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header class="container-fluid">
        <div class="row py-3 align-items-center">
            <div class="col-12 text-center">
                <img src="imagens/logo.png" alt="Logo da Loja" class="logo">
            </div>
        </div>
    </header>

    <div class="container mb-4">
        <div class="row">
            <div class="col-12 col-md-8 mx-auto">
                <div class="search-container">
                    <input type="text" id="search-input" class="form-control" placeholder="Buscar produtos...">
                    <button id="search-button" class="btn search-btn">
                        <span class="icon icon-search"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <nav class="container mb-4">
        <div class="row">
            <div class="col-12">
                <div class="categories-nav position-relative">
                    <!-- Bot√µes de navega√ß√£o para scroll -->
                    <button class="scroll-arrow-btn scroll-left d-none" id="scroll-left">
                        <span class="icon icon-left"></span>
                    </button>
                    
                    <div id="categories-container" class="d-inline-flex px-3 mx-auto">
                        <!-- Categorias ser√£o carregadas aqui via JavaScript -->
                        <button class="category-btn active" data-category="all">
                            <span class="icon icon-grid"></span> Todos
                        </button>
                    </div>
                    
                    <button class="scroll-arrow-btn scroll-right d-none" id="scroll-right">
                        <span class="icon icon-right"></span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main class="container">
        <h2 id="category-title" class="text-center mb-4">Todos os Produtos</h2>
        
        <div id="loading-indicator" class="d-none">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
            </div>
            <p>Carregando produtos...</p>
        </div>
        
        <div id="products-container" class="row">
            <!-- Produtos ser√£o carregados aqui via JavaScript -->
        </div>
    </main>

    <!-- Modal para visualiza√ß√£o detalhada do produto -->
    <div class="modal" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">Detalhes do Produto</h5>
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Fechar">√ó</button>
                </div>
                <div class="modal-body" id="modal-product-details">
                    <!-- Detalhes do produto ser√£o carregados aqui -->
                </div>
            </div>
        </div>
    </div>

    <footer class="container-fluid mt-5 py-3">
        <div class="row">
            <div class="col-12 text-center">
                <p>¬© 2025 Cat√°logo de Semijoias. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Vari√°veis globais
        let allProducts = []; // Armazenar√° todos os produtos carregados
        let currentCategory = 'all'; // Categoria atual selecionada
        let activeCategories = []; // Lista de categorias ativas
        let scrollAmount = 300; // Quantidade de scroll horizontal
        let productModal; // Refer√™ncia ao modal

        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar o modal
            productModal = {
                modal: document.getElementById('productModal'),
                show: function() {
                    this.modal.classList.add('show');
                },
                hide: function() {
                    this.modal.classList.remove('show');
                }
            };
            
            // Configurar bot√£o de fechar do modal
            document.querySelector('.btn-close').addEventListener('click', function() {
                productModal.hide();
            });
            
            // Fechar modal ao clicar fora dele
            window.addEventListener('click', function(event) {
                if (event.target === productModal.modal) {
                    productModal.hide();
                }
            });
            
            // Carregar categorias ativas do arquivo JSON
            loadActiveCategories();
            
            // Configurar o evento de busca
            setupSearch();
            
            // Configurar os bot√µes de navega√ß√£o de categorias
            setupCategoryScrollButtons();
            
            // Adicionar o bot√£o "Todos" para mostrar todos os produtos
            const allButton = document.querySelector('.category-btn[data-category="all"]');
            if (allButton) {
                allButton.addEventListener('click', function() {
                    currentCategory = 'all';
                    document.getElementById('category-title').textContent = 'Todos os Produtos';
                    displayProducts(allProducts);
                    
                    // Remover classe 'active' de todos os bot√µes
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    // Adicionar classe 'active' ao bot√£o "Todos"
                    this.classList.add('active');
                    
                    // Centralizar o bot√£o na √°rea vis√≠vel
                    centerButtonInView(this);
                });
            }
        });

        // Fun√ß√£o para carregar categorias ativas do arquivo JSON
        function loadActiveCategories() {
            showLoading(true);
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'CategoriasAtivas.json', true);
            
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        try {
                            activeCategories = JSON.parse(xhr.responseText);
                            // Processar categorias
                            loadCategories(activeCategories);
                            // Carregar produtos de todas as categorias
                            loadAllProducts(activeCategories);
                        } catch (error) {
                            console.error('Erro ao processar arquivo de categorias:', error);
                            handleCategoriesError();
                        }
                    } else {
                        console.error('Erro ao carregar arquivo de categorias:', xhr.status);
                        handleCategoriesError();
                    }
                }
            };
            
            xhr.onerror = function() {
                console.error('Erro de rede ao carregar as categorias');
                handleCategoriesError();
            };
            
            xhr.send();
        }

        // Fun√ß√£o para lidar com erro ao carregar categorias
        function handleCategoriesError() {
            document.getElementById('categories-container').innerHTML = `
                <div class="alert alert-danger" role="alert">
                    Erro ao carregar categorias. Verifique se o arquivo CategoriasAtivas.json existe na raiz do projeto.
                </div>
            `;
            showLoading(false);
        }

        // Configurar a funcionalidade de busca
        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            
            searchButton.addEventListener('click', function() {
                searchProducts(searchInput.value);
            });
            
            searchInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    searchProducts(searchInput.value);
                }
            });
            
            // Limpar a busca quando o campo estiver vazio
            searchInput.addEventListener('input', function() {
                if (this.value === '') {
                    filterProductsByCategory(currentCategory);
                }
            });
        }

        // Fun√ß√£o para carregar todos os produtos de todas as categorias
        function loadAllProducts(categories) {
            showLoading(true);
            allProducts = []; // Limpar a lista de produtos
            
            let loadedCategories = 0;
            const totalCategories = categories.length;
            
            categories.forEach(category => {
                const categoryDirectory = getCategoryDirectory(category);
                const categoryName = getCategoryFolderName(category);
                
                loadCategoryProducts(categoryName, function(products) {
                    if (products && products.length > 0) {
                        // Adicionar a categoria a cada produto
                        products.forEach(product => {
                            product.category = categoryName;
                            product.displayName = category.name;
                        });
                        
                        // Adicionar produtos √† lista global
                        allProducts = allProducts.concat(products);
                    }
                    
                    loadedCategories++;
                    
                    // Quando todas as categorias forem carregadas
                    if (loadedCategories === totalCategories) {
                        showLoading(false);
                        if (allProducts.length > 0) {
                            // Formatar descri√ß√µes dos produtos (primeira letra mai√∫scula, resto min√∫sculo)
                            allProducts.forEach(product => {
                                if (product.descricao) {
                                    product.descricao = capitalizeFirstLetter(product.descricao);
                                }
                            });
                            
                            displayProducts(allProducts);
                        } else {
                            handleEmptyProductList();
                        }
                    }
                });
            });
            
            // Se nenhum arquivo for carregado em tempo h√°bil
            setTimeout(function() {
                if (allProducts.length === 0) {
                    showLoading(false);
                    handleEmptyProductList();
                }
            }, 5000); // 5 segundos de timeout
        }

        // Fun√ß√£o para obter o diret√≥rio da categoria
        function getCategoryDirectory(category) {
            return category.diretorio;
        }

        // Fun√ß√£o para obter o nome da pasta da categoria
        function getCategoryFolderName(category) {
            // Extrair o nome da pasta do diret√≥rio completo
            const parts = category.diretorio.split('/');
            return parts[parts.length - 1];
        }

        // Fun√ß√£o para capitalizar a primeira letra e deixar o resto min√∫sculo
        function capitalizeFirstLetter(string) {
            if (!string) return string;
            return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
        }

        // Fun√ß√£o para lidar com a lista de produtos vazia
        function handleEmptyProductList() {
            document.getElementById('products-container').innerHTML = `
                <div class="col-12 text-center">
                    <div class="alert alert-warning" role="alert">
                        Nenhum produto encontrado. Verifique se os arquivos JSON est√£o corretos na estrutura de pastas.
                    </div>
                    <p>Exemplo de estrutura esperada:</p>
                    <pre>Catalogos/Braceletes/ItensDescricao.json</pre>
                </div>
            `;
        }

        // Fun√ß√£o para carregar produtos de uma categoria espec√≠fica
        function loadCategoryProducts(category, callback) {
            const xhr = new XMLHttpRequest();
            const url = `Catalogos/${category}/ItensDescricao.json`;
            
            xhr.open('GET', url, true);
            
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        try {
                            const data = JSON.parse(xhr.responseText);
                            if (data && data.produtos && Array.isArray(data.produtos)) {
                                callback(data.produtos);
                            } else {
                                console.error(`Estrutura de dados inv√°lida na categoria ${category}`);
                                callback([]);
                            }
                        } catch (error) {
                            console.error(`Erro ao processar JSON da categoria ${category}:`, error);
                            callback([]);
                        }
                    } else {
                        console.error(`Erro ao carregar arquivo JSON da categoria ${category}:`, xhr.status);
                        callback([]);
                    }
                }
            };
            
            xhr.onerror = function() {
                console.error(`Erro de rede ao carregar a categoria ${category}`);
                callback([]);
            };
            
            xhr.send();
        }

        // Fun√ß√£o para carregar as categorias
        function loadCategories(categories) {
            const categoriesContainer = document.getElementById('categories-container');
            
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                
                // Adicionar √≠cone e texto ao bot√£o
                button.innerHTML = `
                    <span class="icon icon-gem"></span> ${category.name}
                `;
                
                button.dataset.category = getCategoryFolderName(category);
                
                button.addEventListener('click', function() {
                    // Remover classe 'active' de todos os bot√µes
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Adicionar classe 'active' ao bot√£o clicado
                    this.classList.add('active');
                    
                    // Centralizar o bot√£o na √°rea vis√≠vel
                    centerButtonInView(this);
                    
                    const selectedCategory = this.dataset.category;
                    currentCategory = selectedCategory;
                    
                    // Atualizar o t√≠tulo da categoria
                    document.getElementById('category-title').textContent = category.name;
                    
                    // Filtrar e exibir produtos da categoria selecionada
                    filterProductsByCategory(selectedCategory);
                    
                    // Limpar campo de busca
                    document.getElementById('search-input').value = '';
                });
                
                categoriesContainer.appendChild(button);
            });
        }

        // Fun√ß√£o para filtrar produtos por categoria
        function filterProductsByCategory(category) {
            if (category === 'all') {
                displayProducts(allProducts);
            } else {
                const filteredProducts = allProducts.filter(product => product.category === category);
                displayProducts(filteredProducts);
            }
        }

        // Fun√ß√£o para buscar produtos
        function searchProducts(query) {
            if (!query || query.trim() === '') {
                // Se a busca estiver vazia, mostrar produtos da categoria atual
                filterProductsByCategory(currentCategory);
                return;
            }
            
            query = query.trim().toLowerCase();
            
            // Filtrar produtos que cont√™m o termo de busca na descri√ß√£o, c√≥digo ou banho
            let searchResults;
            
            if (currentCategory === 'all') {
                // Buscar em todos os produtos
                searchResults = allProducts.filter(product => 
                    (product.descricao && product.descricao.toLowerCase().includes(query)) ||
                    (product.codigo && product.codigo.toLowerCase().includes(query)) ||
                    (product.banho && product.banho.toLowerCase().includes(query))
                );
            } else {
                // Buscar apenas na categoria atual
                searchResults = allProducts.filter(product => 
                    product.category === currentCategory && 
                    ((product.descricao && product.descricao.toLowerCase().includes(query)) ||
                     (product.codigo && product.codigo.toLowerCase().includes(query)) ||
                     (product.banho && product.banho.toLowerCase().includes(query)))
                );
            }
            
            // Atualizar o t√≠tulo para mostrar os resultados da busca
            document.getElementById('category-title').textContent = 
                `Resultados da busca: "${query}" (${searchResults.length} produtos)`;
            
            displayProducts(searchResults);
        }

        // Fun√ß√£o para exibir os produtos
        function displayProducts(products) {
            const productsContainer = document.getElementById('products-container');
            productsContainer.innerHTML = '';
            
            if (!products || products.length === 0) {
                productsContainer.innerHTML = `
                    <div class="col-12 text-center">
                        <div class="alert alert-info" role="alert">
                            Nenhum produto encontrado.
                        </div>
                    </div>
                `;
                return;
            }
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'col-6 col-md-4 col-lg-3 mb-4';
                
                // Determinar o caminho da imagem
                const imagePath = product.pastaFotos ? 
                    product.pastaFotos + product.imagem : 
                    `Catalogos/${product.category}/${product.codigo}.jpg`;
                
                productCard.innerHTML = `
                    <div class="product-card" data-product-id="${product.codigo}">
                        <div class="product-img-container">
                            <img src="${imagePath}" alt="${product.descricao}" class="product-img" 
                                 onerror="this.src='imagens/produto-sem-foto.png'">
                        </div>
                        <div class="product-info">
                            <div class="product-code">C√≥d: ${product.codigo}</div>
                            <div class="product-title">${product.descricao}</div>
                            <div class="product-price">R$ ${product.preco}</div>
                            <div class="product-bath">${product.banho ? capitalizeFirstLetter(product.banho) : 'Banho n√£o especificado'}</div>
                        </div>
                    </div>
                `;
                
                // Adicionar evento de clique para abrir o modal
                const card = productCard.querySelector('.product-card');
                card.addEventListener('click', function() {
                    openProductModal(product);
                });
                
                productsContainer.appendChild(productCard);
            });
        }

        // Fun√ß√£o para abrir o modal com detalhes do produto
        function openProductModal(product) {
            const modalTitle = document.getElementById('productModalLabel');
            const modalBody = document.getElementById('modal-product-details');
            
            modalTitle.textContent = product.descricao;
            
            // Determinar o caminho da imagem
            const imagePath = product.pastaFotos ? 
                product.pastaFotos + product.imagem : 
                `Catalogos/${product.category}/${product.codigo}.jpg`;
            
            modalBody.innerHTML = `
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <img src="${imagePath}" alt="${product.descricao}" class="modal-product-image" 
                             onerror="this.src='imagens/produto-sem-foto.png'">
                    </div>
                    <div class="col-md-6">
                        <div class="modal-product-details">
                            <div class="modal-product-code">C√≥digo: ${product.codigo}</div>
                            <div class="modal-product-title">${product.descricao}</div>
                            <div class="modal-product-price">R$ ${product.preco}</div>
                            <div class="modal-product-bath">${product.banho ? capitalizeFirstLetter(product.banho) : 'Banho n√£o especificado'}</div>
                            ${product.precoConsignado ? `<div class="modal-product-consigned">Pre√ßo Consignado: R$ ${product.precoConsignado}</div>` : ''}
                            ${product.dataUltimaEntrada ? `<div class="modal-product-date">Data de Entrada: ${product.dataUltimaEntrada}</div>` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            productModal.show();
        }

        // Fun√ß√£o para mostrar/ocultar o indicador de carregamento
        function showLoading(show) {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (show) {
                loadingIndicator.classList.remove('d-none');
            } else {
                loadingIndicator.classList.add('d-none');
            }
        }
        
        // Fun√ß√£o para centralizar um bot√£o na √°rea vis√≠vel
        function centerButtonInView(button) {
            const categoriesContainer = document.getElementById('categories-container');
            if (!categoriesContainer) return;
            
            // Calcular o centro do bot√£o e o centro do container
            const containerWidth = categoriesContainer.offsetWidth;
            const buttonWidth = button.offsetWidth;
            const buttonOffsetLeft = button.offsetLeft;
            
            // Calcular a posi√ß√£o de scroll que centralizar√° o bot√£o
            const targetScrollPosition = buttonOffsetLeft - (containerWidth / 2) + (buttonWidth / 2);
            
            // Aplicar a rolagem suave
            categoriesContainer.scrollTo({
                left: targetScrollPosition,
                behavior: 'smooth'
            });
            
            // For√ßar atualiza√ß√£o da visibilidade dos bot√µes de scroll ap√≥s a centraliza√ß√£o
            setTimeout(function() {
                if (typeof updateScrollButtonsVisibility === 'function') {
                    updateScrollButtonsVisibility();
                }
            }, 400);
        }
        
        // Fun√ß√£o para configurar os bot√µes de scroll horizontal para categorias
        function setupCategoryScrollButtons() {
            const categoriesContainer = document.getElementById('categories-container');
            const scrollLeftBtn = document.getElementById('scroll-left');
            const scrollRightBtn = document.getElementById('scroll-right');
            
            // Verificar se os elementos existem
            if (!categoriesContainer || !scrollLeftBtn || !scrollRightBtn) {
                return;
            }
            
            // Fun√ß√£o para verificar e atualizar visibilidade dos bot√µes de scroll
            function updateScrollButtonsVisibility() {
                // Mostrar bot√£o esquerdo apenas se houver conte√∫do √† esquerda para scrollar
                if (categoriesContainer.scrollLeft > 0) {
                    scrollLeftBtn.classList.remove('d-none');
                } else {
                    scrollLeftBtn.classList.add('d-none');
                }
                
                // Mostrar bot√£o direito apenas se houver mais conte√∫do √† direita
                const maxScrollLeft = categoriesContainer.scrollWidth - categoriesContainer.clientWidth;
                if (categoriesContainer.scrollLeft < maxScrollLeft - 10) { // 10px tolerance
                    scrollRightBtn.classList.remove('d-none');
                } else {
                    scrollRightBtn.classList.add('d-none');
                }
            }
            
            // Adicionar eventos aos bot√µes
            scrollLeftBtn.addEventListener('click', function() {
                categoriesContainer.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
                
                // Verificar visibilidade ap√≥s o scroll
                setTimeout(updateScrollButtonsVisibility, 350);
            });
            
            scrollRightBtn.addEventListener('click', function() {
                categoriesContainer.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
                
                // Verificar visibilidade ap√≥s o scroll
                setTimeout(updateScrollButtonsVisibility, 350);
            });
            
            // Verificar visibilidade inicial
            updateScrollButtonsVisibility();
            
            // Adicionar listener para atualizar visibilidade durante o scroll
            categoriesContainer.addEventListener('scroll', updateScrollButtonsVisibility);
            
            // Atualizar quando a janela for redimensionada
            window.addEventListener('resize', updateScrollButtonsVisibility);
        }
    </script>
</body>
</html>
